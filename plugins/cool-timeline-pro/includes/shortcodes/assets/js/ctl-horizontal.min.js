class CtlHorizontal{constructor(){this.ctlWrapper=jQuery(".cool-timeline-wrapper.ctl-horizontal-wrapper"),this.ctlWrapper.length>0&&this.storyLoop()}initializeMainSlider=()=>{const swiperAttr=this.ctlSlideAttribute(),swiperObj=new Swiper(this.mainSwiper,swiperAttr);if(this.initializeSliderNav(swiperObj),this.swiperOnChange(swiperObj),swiperObj.pagination.el&&this.ctlScrollFilling(swiperObj),swiperAttr.autoHeight){const adjustHeight=()=>{this.autoAdjustSwiperHeight(swiperObj)};adjustHeight(),swiperObj.on("slideChange",adjustHeight)}};initializeSliderNav=swiperObj=>{const navWrpCls=this.parentWrp.attr("class").split(" "),navSlider=["ctl-default","ctl-design-6","ctl-design-8"],navLayout=navSlider.find(element=>navWrpCls.includes(element));if(navLayout){const navContainer=this.parentWrp.find(".ctl-nav-slider-container")[0];if(navContainer){const navSlideAttr=this.ctlYearSlideAttribute(),navSwiper=new Swiper(navContainer,navSlideAttr);swiperObj.controller.control=navSwiper,navSwiper.controller.control=swiperObj}}};swiperOnChange=swiperObj=>{let slideChangeComplete=!1;swiperObj.on("slideChange",event=>{const parentContainer=jQuery(swiperObj.el.closest(".ctl-horizontal-wrapper")),parentWrp=parentContainer.closest(".ctl-wrapper"),navWrp=parentContainer.data("nav"),activeIndex=swiperObj.activeIndex;if("show"===navWrp){let activeSlide="";const navSliderWrp=parentContainer.find(".ctl-nav-slider-container");activeSlide=navSliderWrp.length>0?navSliderWrp.find(".ctl-year-swiper-slide")[activeIndex]:swiperObj.slides[activeIndex];const activeYear=this.activeYearLabel(activeSlide),navButton=parentWrp.find(".ctl-nav-dropdown-button span");if(navButton.text()!==activeYear){const listItem=parentWrp.find(".ctl-nav li");navButton.text(activeYear),listItem.removeClass("active"),listItem.each((key,element)=>{element.innerText===activeYear&&element.classList.add("active")})}}if(swiperObj.pagination.el){let scrollFilling;slideChangeComplete=!1,this.ctlScrollFilling(swiperObj),scrollFilling=setInterval(()=>{this.ctlScrollFilling(swiperObj),slideChangeComplete&&clearInterval(scrollFilling)},100)}}),swiperObj.on("slideChangeTransitionEnd",()=>{swiperObj.pagination.el&&(slideChangeComplete=!0)})};ctlScrollFilling=obj=>{const swiperWrp=obj.el;if(swiperWrp){const parentWrp=swiperWrp.closest(".cool-timeline-wrapper");if(parentWrp){const iconFilling=["ctl-design-1","ctl-design-2","ctl-design-6"].some(design=>parentWrp.classList.contains(design)),yearFilling=["ctl-design-6","ctl-design-2"].some(design=>parentWrp.classList.contains(design));if(iconFilling||yearFilling){const sliderLeftPostion=swiperWrp.getBoundingClientRect().left-swiperWrp.offsetLeft,pagination=obj.pagination.el.querySelector(".swiper-pagination-progressbar-fill"),paginationTransformStyle=pagination.style.transform,progressValue=paginationTransformStyle.match(/scaleX\(([^)]+)\)/)[1],paginationWidth=Math.round(pagination.offsetWidth*progressValue),stories=parentWrp.classList.contains("ctl-design-6")?parentWrp.querySelectorAll(".ctl-nav-slider-container .ctl-year-swiper-slide"):parentWrp.querySelectorAll(".ctl-slider-container .ctl-story");for(let i=0;i<stories.length;i++){if(yearFilling){const yearLabel=stories[i].querySelector(".timeline-year .ctl-year-text");if(yearLabel){const yearLeftPosition=yearLabel.getBoundingClientRect().left,yearPosition=yearLeftPosition-sliderLeftPostion;paginationWidth>=yearPosition?yearLabel.classList.add("ctl-in-view-port"):yearLabel.classList.remove("ctl-in-view-port")}}if(iconFilling){const icon=stories[i].querySelector(".ctl-icondot,.ctl-icon");if(icon){const iconLeftPosition=icon.getBoundingClientRect().left,storyPosition=iconLeftPosition-sliderLeftPostion;paginationWidth>=storyPosition?stories[i].classList.add("ctl-in-view-port"):stories[i].classList.remove("ctl-in-view-port")}}}}}}};autoAdjustSwiperHeight=event=>{const previousHeights={swiperHeight:"",mediaSwiperHeight:""},currentSlide=swiper=>{const{activeIndex:activeIndex,params:{slidesPerView:slidesPerView},slides:slides}=swiper,slide=Array.prototype.slice.call(slides);return slide.slice(activeIndex,activeIndex+slidesPerView)},observerCallback=mutations=>{const currentElement=jQuery(mutations[0].target).hasClass("ctp-media-slider")?"mediaSwiperHeight":"swiperHeight",currentWrapperHeight=jQuery(mutations[0].target).height();previousHeights[currentElement]!==currentWrapperHeight&&(previousHeights[currentElement]=currentWrapperHeight,mutations.some(mutation=>"attributes"===mutation.type&&"style"===mutation.attributeName)&&heightUpdate(event))},observer=new MutationObserver(observerCallback),heightUpdate=swiper=>{const activeSlides=currentSlide(swiper),wrpHeight=Math.max(...activeSlides.map(jQuery).map(element=>element.outerHeight(!0)));jQuery(swiper.el).height(wrpHeight)},OBSERVER_CONFIG={attributes:!0},startObserving=target=>observer.observe(target,OBSERVER_CONFIG);event.slidesEl&&startObserving(event.slidesEl),setTimeout(()=>{const mediaSlides=jQuery(event.slidesEl).find(".ctp-media-slider .ctp-story-slider.swiper-initialized");mediaSlides.each((index,element)=>{startObserving(element.swiper.slidesEl)})},500),heightUpdate(event)};yearFilterSliderControl=id=>{const parentWrp=jQuery(`.ctl-wrapper #${id}`).closest(".ctl-wrapper"),slideToIndex=event=>{const yearLabel=event.currentTarget.innerText,yearWrp=parentWrp.find(`.timeline-year#year-${yearLabel}`),index=parseInt(yearWrp.parent().data("story-index")),swiper=parentWrp.find(".ctl-slider-container")[0].swiper;swiper.slideTo(index-1)},navItems=parentWrp.find(".ctl-navigation-bar li");navItems&&navItems.click(slideToIndex)};ctlHrYearNavigation=()=>{const wrpId=this.parentWrp[0].id,postId=Number(wrpId.replace(/\D/g,"")),allYears=this.parentWrp.find(".scrollable-section"),yearWrp=this.parentWrp.closest(".ctl-wrapper").find(".ctl-navigation-bar"),YearWrpId=`ctl-navigation-bar-${postId}`,navPostion=`ctl-nav-${this.parentWrp.data("nav-pos")}`,currentSlider=this.parentWrp.find(".ctl-slider-container .ctl-story.swiper-slide-active, .ctl-year-swiper-slide.swiper-slide-active"),activeYear=this.activeYearLabel(currentSlider[0]);yearWrp.attr("id",YearWrpId);const dropdownButton=jQuery("<button>",{role:"button","data-value":"",class:"ctl-nav-dropdown-button",style:"display: none"}).html(`<span>${activeYear}</span> ${this.CtlStaticSvgIcons("chevronUp")}`),dropdownList=jQuery("<ul>",{class:`ctl-nav ${navPostion}`,role:"tablist"}),dropdown=jQuery("<div>",{class:"ctl-nav-default ctl-nav-container"}).append(dropdownButton,dropdownList);yearWrp.append(dropdown),allYears.each((index,element)=>{this.ctlYearLiElement(YearWrpId,element,activeYear)}),this.yearFilterStyle(this.parentWrp[0].id)};yearFilterStyle=id=>{const navWrapper=jQuery(`#${id}`).closest(".ctl-wrapper").find(".ctl-nav-container"),liElement=navWrapper.find("li");liElement.length<5?(navWrapper.find("button.ctl-nav-dropdown-button").css("display","none"),navWrapper.addClass("ctl-nav-default").removeClass("ctl-nav-dropdown")):(navWrapper.find("button.ctl-nav-dropdown-button").css("display","block"),navWrapper.addClass("ctl-nav-dropdown").removeClass("ctl-nav-default")),this.yearFilterSliderControl(id)};ctlYearLiElement=(navId,element,activeYear)=>{const listItem=jQuery("<li>",{class:`ctl-nav-item${element.innerText===activeYear?" active":""}`,role:"tab"}),anchorTag=jQuery("<a>",{text:element.innerText});listItem.append(anchorTag);const dropdownList=jQuery(`#${navId}`).find("ul");dropdownList.append(listItem)};activeYearLabel=element=>{const currentYear=jQuery(element).find(".timeline-year");if(0>=currentYear.length){const preveYearWrp=jQuery(element).prevAll(".ctl-story,.ctl-year-swiper-slide"),allYearWrp=preveYearWrp.filter((e,data)=>jQuery(data).find(".timeline-year").length>0),activeYear=jQuery(allYearWrp[0]).find(".timeline-year");return activeYear.text()}return currentYear.text()};ctlSlideAttribute=()=>{this.slideChangeComplete=!1;const element=jQuery(this.parentWrp),direction=element.data("dir"),nextButton=element.find(".ctl-button-next")[0],prevButton=element.find(".ctl-button-prev")[0],initialSlide=parseInt(element.data("start-on"))||0,autoplay=!!element.data("autoplay"),autoplaySpeed=parseInt(element.data("autoplay-speed"))||0,pagination=!!element.data("line-filling")&&element.find(".ctl-line-fill")[0],showSlides=""===element.data("items")?element.hasClass("ctl-design-7")?6:3:parseInt(element.data("items"));let navigation={nextEl:nextButton,prevEl:prevButton};"rtl"===direction&&(navigation={nextEl:prevButton,prevEl:nextButton});const navWrpCls=element.attr("class").split(" "),navSlider=["ctl-default","ctl-design-6","ctl-design-8"],navLayout=navSlider.find(navElement=>navWrpCls.includes(navElement)),attribute={slidesPerGroup:1,initialSlide:initialSlide,autoplay:!!autoplay&&{delay:autoplaySpeed,disableOnInteraction:!0},autoHeight:!0,pagination:{el:pagination,type:"progressbar"},slidesPerView:navLayout?1:showSlides,navigation:navigation,breakpoints:{0:{slidesPerView:1},640:{slidesPerView:1},768:{slidesPerView:navLayout?1:2},1024:{slidesPerView:navLayout?1:showSlides}}};return attribute};ctlYearSlideAttribute=()=>{const element=this.parentWrp,initialSlide=""===element.data("start-on")?0:parseInt(element.data("start-on"))-1,items=""===jQuery(element).data("items")?3:parseInt(jQuery(element).data("items")),showSlides=items%2==0?items+1:items,attribute={slidesPerView:1,slidesPerGroup:1,initialSlide:initialSlide,centeredSlides:!0,slideToClickedSlide:!0,breakpoints:{640:{slidesPerView:1},768:{slidesPerView:1},1024:{slidesPerView:showSlides}}};return attribute};CtlStaticSvgIcons=icon=>{const iconsArr={chevronLeft:'<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 320 512">\n\t\t\t<path d="M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"/>\n\t\t\t</svg>',chevronRight:'<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 320 512">\n\t\t\t<path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/>\n\t\t\t</svg>',chevronUp:'<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512">\n\t\t\t<path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/>\n\t\t\t</svg>'},data=void 0!==iconsArr[icon]?iconsArr[icon]:"";return data};storyLoop=()=>{this.ctlWrapper.each((index,element)=>{const container=jQuery(element).find(".ctl-timeline-container"),totalStory=container.find(".ctl-story").length;0===totalStory&&jQuery(element).addClass("ctl-content-empty"),this.index=index,this.parentWrp=jQuery(element),this.mainSwiper=this.parentWrp.find(".ctl-slider-container")[0],this.initializeMainSlider(),"show"===this.parentWrp.data("nav")&&this.ctlHrYearNavigation()})}}jQuery,new CtlHorizontal;