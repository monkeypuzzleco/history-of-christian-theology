class CtlVertical{constructor(){this.prevScrollComplete=!0,this.swiperInitId=new Array,this.ctlWrapper=jQuery(".cool-timeline-wrapper.ctl-vertical-wrapper"),this.ctlWrapper.length>0&&this.storyLoop(),this.ctlWrapper.hasClass("ctl-compact-wrapper")&&this.compactLayoutInit()}delay=ms=>new Promise(resolve=>setTimeout(resolve,ms));VrLineFillCallback=async()=>{await this.delay(200),jQuery(".ctl-vertical-wrapper").each((index,element)=>{const parentWrp=jQuery(element);this.CtlVrLineFilling(parentWrp)})};CtlVrLineFilling=element=>{const parentWrp=element,timelineYear=parentWrp.find(".ctl-year"),lineFilling=parentWrp.data("line-filling"),Stories=parentWrp.find(".ctl-story");let rect="",ctlTop="",height="",centerLine="";if(lineFilling&&Stories.length>0){const outerDiv=parentWrp.hasClass("compact-wrapper")?parentWrp.find(".clt-compact-cont"):parentWrp.find(".ctl-timeline-container"),outerHeight=outerDiv.outerHeight();rect=outerDiv[0].getBoundingClientRect();const shortcodePrview=window.parent.jQuery("#ctl_preview");height=shortcodePrview.length>0?shortcodePrview.height()/2:jQuery(window).height()/2,centerLine=parentWrp.find(".ctl-inner-line"),ctlTop=rect.top<0?Math.abs(rect.top):-Math.abs(rect.top);const lineInnerHeight=ctlTop+height,centerLineHeight=centerLine.height(),topScroll=jQuery(window).scrollTop()+height+10;centerLine.height(lineInnerHeight<=outerHeight?lineInnerHeight:outerHeight),timelineYear.each((index,year)=>{const yearPosition=jQuery(year).offset().top,yearHeight=jQuery(year).height()/1.5;jQuery(year).toggleClass("innerViewPort",topScroll>=yearPosition+yearHeight)}),jQuery(Stories[0])&&!jQuery(Stories[0]).hasClass("ctl-story-no-icon")&&Stories.each((index,wrp)=>{const icons=wrp.classList.contains("ctl-story-dot-icon")?".ctl-icondot":".ctl-icon",iconsSize=jQuery(wrp).find(icons).width(),iconPosition=jQuery(wrp).find(icons).offset().top+iconsSize/2;jQuery(wrp).toggleClass("innerViewPort",topScroll>=iconPosition)}),lineInnerHeight>=outerHeight&&centerLineHeight<outerHeight&&centerLine.height(outerHeight);const centerLineElement=parentWrp.find(".center-line");parentWrp.toggleClass("ctl-start-fill",lineInnerHeight>0),centerLineElement.toggleClass("BeforeViewPort",lineInnerHeight>0),centerLineElement.toggleClass("AfterViewPort",lineInnerHeight>=outerHeight),parentWrp.toggleClass("ctl-end-fill",lineInnerHeight>=outerHeight)}};ctlYearNavigation=element=>{const selector=jQuery(element),navBarEnable=selector.data("nav"),navStyle=selector.data("nav-style"),wrpId=selector[0].id,postId=Number(wrpId.replace(/\D/g,"")),yearEntry=selector.find(".scrollable-section");if(yearEntry.length>0&&"show"===navBarEnable){if(!selector.find(".ctl-navigation-bar").length){const navPosition=selector.data("nav-pos"),navBar=`<nav id="ctl-navigation-bar-${postId}" class="ctl-navigation-bar ctl-nav-position-${navPosition} ctl-nav-${navStyle}"></nav>`;jQuery(navBar).prependTo(`#${wrpId}`);const listAll=jQuery('<ul class="ctl-navigation-items"></ul>');if("style-2"!==navStyle){const navIcon='<div class="ctl-nav-icon"><span></span><span></span><span></span></div>';selector.find(".ctl-navigation-bar").append(navIcon),jQuery(document).on("click",`#${wrpId} .ctl-navigation-bar .ctl-nav-icon`,(function(e){jQuery(e.currentTarget).closest(".ctl-navigation-bar").toggleClass("ctl-nav-active")}))}selector.find(".ctl-navigation-bar").append(listAll)}const navigationBar=selector.find(".ctl-navigation-bar");navigationBar.addClass("ctl-out-viewport");const navigator=selector.find(".ctl-year-container");navigator.each((i,labelWrp)=>{this.CtlNavLiElement(i,wrpId,labelWrp)}),this.yearNavHandleScroll({data:selector}),jQuery(window).on("scroll",selector,this.yearNavHandleScroll),this.ctlYearScrollAnimation()}};yearNavHandleScroll=async event=>{const selector=event.data,TimelineStories=selector.find(".ctl-story"),compact=selector.hasClass("ctl-compact-wrapper"),laststory=TimelineStories[TimelineStories.length-1],rootElement=document.documentElement,viewport=jQuery(window).height()/3,timelineWrapperPosition=selector.offset().top,laststoryDiv=jQuery(laststory),navigationBar=selector.find(".ctl-navigation-bar"),mainNavLinks=navigationBar.find("ul li a");let previousEl=null;if(laststoryDiv.length>0){const timelineBottom=laststoryDiv.offset().top+laststoryDiv.height()-rootElement.scrollTop,timelineTop=timelineWrapperPosition-rootElement.scrollTop;navigationBar.toggleClass("ctl-in-viewport",timelineTop<viewport),navigationBar.toggleClass("ctl-out-viewport",timelineTop>=viewport||timelineBottom<viewport);const extraspace=compact?70:400,fromTop=window.scrollY+extraspace;mainNavLinks.each((function(){const hash=this.hash;if(!jQuery(hash).length)return!1;const section=jQuery(hash).offset().top;section<=fromTop&&(null!==previousEl&&previousEl.removeClass("current").parent().removeClass("current"),jQuery(this).addClass("current").parent().addClass("current")),section>=fromTop&&jQuery(this).removeClass("current").parent().removeClass("current"),previousEl=jQuery(this)}))}};CtlNavLiElement=(index,wrpId,labelWrp)=>{const postId=Number(wrpId.replace(/\D/g,"")),YeraLabel=jQuery(labelWrp).data("section-title"),uniqueID=`${postId}-${YeraLabel}`,scrollbarID=`ctl-scrollar-${uniqueID}`;jQuery(labelWrp).attr("id",scrollbarID);const listEl=jQuery(`<li><a href="#${scrollbarID}">${YeraLabel}</a></li>`);0===index&&listEl.addClass("current");const ulList=jQuery(`#ctl-navigation-bar-${postId}`).find("ul");ulList.append(listEl)};ctlYearScrollAnimation=()=>{jQuery(document).on("click",".ctl-vertical-wrapper .ctl-navigation-bar ul li",e=>{if(this.prevScrollComplete){this.prevScrollComplete=!1,e.preventDefault();const targetElement=jQuery(e.currentTarget).find("a").attr("href");if(targetElement.length){const targetTopPosition=jQuery(targetElement).offset().top-40;jQuery("html, body").animate({scrollTop:targetTopPosition},500,()=>{this.prevScrollComplete=!0})}}})};CtlStoryAos=wrapperId=>{const parentWrp=jQuery(`#${wrapperId}`),timelineContainer=parentWrp.find(".ctl-timeline-container"),animation=timelineContainer.attr("data-animation");let prevHeight=jQuery(`#${wrapperId}`).height();const parentWrpAosCls=!parentWrp.hasClass("ctl-compact-wrapper")&&parentWrp.hasClass("ctl-design-6");"none"!==animation&&(parentWrp.hasClass("ctl-compact-wrapper")||timelineContainer.find(".timeline-year.scrollable-section").each((_index,element)=>{element.dataset.aos=""}),timelineContainer.find(".ctl-story").each((index,story)=>{parentWrpAosCls?story.dataset.aos="":jQuery(story).find(".ctl-icon, .ctl-content, .ctl-labels, .ctl-icondot, .ctl-arrow").each((_index,element)=>{element.dataset.aos=""})}),AOS.init({disable:"mobile",startEvent:"DOMContentLoaded",offset:75,delay:0,duration:750,easing:"ease-in-out-sine",mirror:!0}),parentWrp.hasClass("ctl-compact-wrapper")||timelineContainer.find(".timeline-year.scrollable-section").each((_index,element)=>{element.dataset.aos=animation}),timelineContainer.find(".ctl-story").each((index,story)=>{parentWrpAosCls?story.dataset.aos=animation:jQuery(story).find(".ctl-icon, .ctl-content, .ctl-labels, .ctl-icondot, .ctl-arrow").each((_index,element)=>{element.dataset.aos=animation})}),setTimeout(()=>{AOS.refresh()},500)),jQuery(window).scroll(()=>{const currentHeight=jQuery(`#${wrapperId}`).height();prevHeight!==currentHeight&&(setTimeout((function(){AOS.refresh()}),500),prevHeight=currentHeight)})};ctlCompactMasonry=(grids,animation,reloadItems)=>{let grid="",leftReminder=0,rightReminder=0;grid=reloadItems?grids.masonry("reloadItems"):grids.masonry({itemSelector:".ctl-story",initLayout:!1}),grid.imagesLoaded().progress(()=>{grid.masonry("layout")}),grid.one("layoutComplete",()=>{let leftPos=0,topPosDiff;grid.find(".ctl-story").each((index,element)=>{if(leftPos=jQuery(element).position().left,leftPos<=0){const extraCls=leftReminder%2==0?"ctl-left-odd":"ctl-left-even",prevCls="ctl-left-odd"===extraCls?"ctl-left-even":"ctl-left-odd";jQuery(element).removeClass("ctl-story-right").removeClass("ctl-right-even").removeClass("ctl-right-odd").removeClass(prevCls).addClass("ctl-story-left").addClass(extraCls),leftReminder++}else{const extraCls=rightReminder%2==0?"ctl-right-odd":"ctl-right-even",prevCls="ctl-right-odd"===extraCls?"ctl-right-even":"ctl-right-odd";jQuery(element).removeClass("ctl-story-left").removeClass("ctl-left-odd").removeClass("ctl-left-even").removeClass(prevCls).addClass("ctl-story-right").addClass(extraCls),rightReminder++}topPosDiff=jQuery(element).position().top-jQuery(element).prev().position().top,topPosDiff<40&&(jQuery(element).removeClass("ctl-compact-up").addClass("ctl-compact-down"),jQuery(element).prev().removeClass("ctl-compact-down").addClass("ctl-compact-up"))}),jQuery(".ctl-icon").addClass("showit"),jQuery(".ctl-title").addClass("showit-after"),"none"!==animation&&AOS.refreshHard()})};CtlStaticSvgIcons=icon=>{const iconsArr={chevronLeft:'<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 320 512">\n\t\t\t<path d="M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"/>\n\t\t\t</svg>',chevronRight:'<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 320 512">\n\t\t\t<path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/>\n\t\t\t</svg>'},data=void 0!==iconsArr[icon]?iconsArr[icon]:"";return data};storyLoop=()=>{this.ctlWrapper.each((index,element)=>{const container=jQuery(element).find(".ctl-timeline-container"),totalStory=container.find(".ctl-story").length,parentWrp=jQuery(element),timelineContainer=parentWrp.find(".ctl-timeline-container")[0],animation=jQuery(timelineContainer).attr("data-animation");0===totalStory&&jQuery(element).addClass("ctl-content-empty"),"none"!==animation&&void 0!==animation&&this.CtlStoryAos(parentWrp[0].id,animation),this.CtlVrLineFilling(parentWrp),jQuery(window).on("scroll",parentWrp,el=>{this.CtlVrLineFilling(el.data);const mediaSlides=jQuery(parentWrp).find(".ctl-story .ctp-story-slider.swiper-initialized");mediaSlides.each((index,element)=>{const swiper=element.swiper,id=swiper.slidesEl.id;this.swiperInitId.includes(id)||(this.swiperInitId.push(id),swiper.on("slideChange",()=>{this.VrLineFillCallback()}))})}),this.ctlYearNavigation(element)})};compactLayoutInit(){const initializeCompactMasonry=()=>{const wrapper=jQuery(".ctl-compact-wrapper .ctl-timeline-container"),animation=wrapper.data("animation");this.ctlCompactMasonry(wrapper,animation)};jQuery(document).ready(initializeCompactMasonry),jQuery(window).on("load",(function(){setTimeout(initializeCompactMasonry,200)})),jQuery(window).on("resize",initializeCompactMasonry)}}jQuery,new CtlVertical;